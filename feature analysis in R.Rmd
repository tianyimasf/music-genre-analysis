---
title: "Music genre feature analysis"
author: "Tianyi Ma (Alex)"
date: "05.09.2023"
output: html_document
    # odt_document: default
    # word_document: default
    # pdf_document: default
# editor_options:
  # chunk_output_type: console
editor_options: 
  chunk_output_type: inline
---

## Installing and loading common packages and libraries

```{r}
install.packages('devtools')
```

```{r}
install.packages('tidyverse', repos = "http://cran.us.r-project.org")
devtools::install_github("hrbrmstr/hrbrthemes")
install.packages('viridis')
```

```{r}
library(tidyverse)
library(ggplot2)
library(dplyr)
library(tidyr)
library(forcats)
library(hrbrthemes)
library(viridis)
library(lubridate)
```

## Loading data csv

```{r}
df <- read.csv("data/music genre data.csv", header=TRUE)
```

```{r}
df
```


```{r}
by_genre <- df %>% group_by(Genre)
by_genre
```


```{r}
alt <- by_genre %>% filter(Genre=="Alt")
alt
```

```{r}
col_names <- colnames(df)
col_names
```
```{r}
feature_names <- c(col_names[3:6], col_names[8:11])
feature_names
```
```{r}
loudness_min <- min(alt$loudness)
loudness_max <- max(alt$loudness)
loudness_range <- loudness_max - loudness_min
alt$loudness <- (alt$loudness - loudness_min)/loudness_range
```


```{r}
plot_alt <- pivot_longer(alt, cols = feature_names)
plot_alt$name <- factor(plot_alt$name, feature_names)

p <- plot_alt %>%
  ggplot( aes(x=name, y=value, fill=name, color=name)) +
    geom_violin(width=2.1, size=0.2) +
    scale_fill_viridis(discrete=TRUE) +
    scale_color_viridis(discrete=TRUE) +
    theme_ipsum() +
    theme(
      legend.position="none",
      axis.text.x = element_text(angle = 30, hjust=0.8),
      axis.title.x = element_text(size = 12, hjust=0.45, vjust=0)
    ) +
    xlab("Music Features") +
    ylab("Distribution") +
    ggtitle("Value Distribution for Genre: Alt")

p
```









