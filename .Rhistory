df_bins %>% group_by(Genre) %>% group_map(~plot_lolipop_2groups(.x, .y))
plot_lolipop_2groups <- function(group_tb, group_by_column) {
group_bins <- cut(group_tb$Popularity, breaks = breaks, labels = labels)
group_unique_value_freq <- as.data.frame(table(group_bins))
unique_value_freq$Freq_group <- group_unique_value_freq$Freq
max_freq <- max(unique_value_freq$Freq)
max_group_freq <- max(unique_value_freq$Freq_group)
unique_value_freq$Freq_normalized <- as.integer(unique_value_freq$Freq*max_group_freq/max_freq)
tb_genre <- group_by_column$Genre
ggplot(unique_value_freq) +
geom_segment( aes(x=bins, xend=bins, y=Freq_normalized, yend=Freq_group), color="grey") +
geom_point( aes(x=bins, y=Freq_normalized), color="#9fc0de", size=4, alpha=0.65 ) +
geom_point( aes(x=bins, y=Freq_group), color="#ff985a", size=4, alpha=0.5 ) +
theme_ipsum() +
theme(
panel.grid.major.x = element_blank(),
panel.border = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_text(angle = 30, hjust=0.6),
) +
xlab("Popularity Range") +
ylab("# of songs with popularity in range") +
ggtitle(paste("Popularity distribution in general vs. ", tb_genre))
}
df_bins <- df
df_bins$bins <- bins
df_bins %>% group_by(Genre) %>% group_map(~plot_lolipop_2groups(.x, .y))
install.packages("fmsb")
library(tidyverse)
library(ggplot2)
library(dplyr)
library(tidyr)
library(forcats)
library(hrbrthemes)
library(viridis)
library(lubridate)
library(ggbeeswarm)
library(fmsb)
by_genre <- df %>% group_by(Genre)
by_genre
col_names <- colnames(df)
col_names
feature_names <- c(col_names[3:6], col_names[8:12])
feature_names
feature_names <- feature_names[! feature_names%in% c("loudness", "tempo")]
feature_names
colnames(data) <- c("math" , "english" , "biology" , "music" , "R-coding", "data-viz" , "french" , "physic", "statistic", "sport" )
# Create data: note in High school for Jonathan:
dataset <- as.data.frame(matrix( sample( 2:20 , 10 , replace=T) , ncol=10))
colnames(dataset) <- c("math" , "english" , "biology" , "music" , "R-coding", "data-viz" , "french" , "physic", "statistic", "sport" )
# To use the fmsb package, I have to add 2 lines to the dataframe: the max and min of each topic to show on the plot!
dataset <- rbind(rep(20,10) , rep(0,10) , dataset)
# Check your data, it has to look like this!
head(dataset)
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(feature_names[i])
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(tb_sub[,feature_names[i]][1:10])
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(tb_sub[,feature_names[i]])
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(as.numeric(tb_sub[,feature_names[i]]))
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(tb_sub[,feature_names[i]][1])
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(as.numeric(as.character(tb_sub[,feature_names[i]])))
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(as.numeric(as.character(tb_sub[,feature_names[i]])))
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(typeof(tb_sub[,feature_names[i]]))
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(tb_sub[,feature_names[i][[1]]])
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(tb_sub[,feature_names[i]][1,])
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(typeof(tb_sub[,feature_names[i]][1,]))
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(as.numeric(tb_sub[,feature_names[i]][1,]))
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(typeof(as.numeric(tb_sub[,feature_names[i]][1,])))
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(as.numeric(as.character(unlist(tb_sub[,feature_names[i]]))))
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
col_numeric <- as.numeric(as.character(unlist(tb_sub[,feature_names[i]])))
medians[i] <- median(col_numeric)
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
col_numeric <- as.numeric(as.character(unlist(tb_sub[,feature_names[i]])))
medians[i] <- median(col_numeric)
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#779ecc" , pfcol="#9fc0de" , plwd=7 , alpha=0.65,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
col_numeric <- as.numeric(as.character(unlist(tb_sub[,feature_names[i]])))
medians[i] <- median(col_numeric)
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#779ecc" , pfcol="#9fc0de" , plwd=3,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
col_numeric <- as.numeric(as.character(unlist(tb_sub[,feature_names[i]])))
medians[i] <- median(col_numeric)
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
tb_genre <- group_by_column$Genre
if (tb_genre == "") {
return("")
}
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#779ecc" , pfcol="#9fc0de" , plwd=3,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8, title=tb_genre
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
