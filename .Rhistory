cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(tb_sub[,feature_names[i]][1:10])
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(tb_sub[,feature_names[i]])
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(as.numeric(tb_sub[,feature_names[i]]))
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(tb_sub[,feature_names[i]][1])
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(as.numeric(as.character(tb_sub[,feature_names[i]])))
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(as.numeric(as.character(tb_sub[,feature_names[i]])))
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(typeof(tb_sub[,feature_names[i]]))
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(tb_sub[,feature_names[i][[1]]])
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(tb_sub[,feature_names[i]][1,])
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(typeof(tb_sub[,feature_names[i]][1,]))
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(as.numeric(tb_sub[,feature_names[i]][1,]))
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(typeof(as.numeric(tb_sub[,feature_names[i]][1,])))
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
print(as.numeric(as.character(unlist(tb_sub[,feature_names[i]]))))
medians[i] <- median(tb_sub[,feature_names[i]])
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
col_numeric <- as.numeric(as.character(unlist(tb_sub[,feature_names[i]])))
medians[i] <- median(col_numeric)
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#9fc0de" , pfcol="#9fc0de" , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
col_numeric <- as.numeric(as.character(unlist(tb_sub[,feature_names[i]])))
medians[i] <- median(col_numeric)
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#779ecc" , pfcol="#9fc0de" , plwd=7 , alpha=0.65,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
col_numeric <- as.numeric(as.character(unlist(tb_sub[,feature_names[i]])))
medians[i] <- median(col_numeric)
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#779ecc" , pfcol="#9fc0de" , plwd=3,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
col_numeric <- as.numeric(as.character(unlist(tb_sub[,feature_names[i]])))
medians[i] <- median(col_numeric)
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
tb_genre <- group_by_column$Genre
if (tb_genre == "") {
return("")
}
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#779ecc" , pfcol="#9fc0de" , plwd=3,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8, title=tb_genre
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
library(tidyverse)
library(ggplot2)
library(dplyr)
library(tidyr)
library(forcats)
library(hrbrthemes)
library(viridis)
library(lubridate)
library(ggbeeswarm)
library(fmsb)
df <- read.csv("data/music genre data.csv", header=TRUE)
df <- df %>% drop_na()
df
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
col_numeric <- as.numeric(as.character(unlist(tb_sub[,feature_names[i]])))
medians[i] <- median(col_numeric)
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
tb_genre <- group_by_column$Genre
if (tb_genre == "") {
return("")
}
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#779ecc" , pfcol="#9fc0de" , plwd=3,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8, title=tb_genre
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
col_numeric <- as.numeric(as.character(unlist(tb_sub[,feature_names[i]])))
medians[i] <- median(col_numeric)
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
tb_genre <- group_by_column$Genre
print(paste("genre", tb_genre))
if (tb_genre == "") {
return("")
}
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#779ecc" , pfcol="#9fc0de" , plwd=3,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8, title=tb_genre
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
radar_plot_tb <- function(tb, group_by_column){
tb_sub <- tb[,feature_names]
medians <- c()
for (i in 1:length(feature_names)){
col_numeric <- as.numeric(as.character(unlist(tb_sub[,feature_names[i]])))
medians[i] <- median(col_numeric)
}
range_max <- rep(1, length(feature_names))
range_min <- rep(0, length(feature_names))
data_tb <- data.frame(matrix(ncol = length(feature_names), nrow = 0))
colnames(data_tb) <- feature_names
tb_genre <- group_by_column$Genre
data_tb[1,] <- range_max
data_tb[2,] <- range_min
data_tb[3,] <- medians
radarchart( data_tb, axistype=1 ,
#custom polygon
pcol="#779ecc" , pfcol="#9fc0de" , plwd=3,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,0.1), cglwd=0.8,
#custom labels
vlcex=0.8, title=tb_genre
)
}
by_genre %>% group_map(~radar_plot_tb(.x, .y))
